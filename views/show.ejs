<%- include("partials/header") %>
<link rel="stylesheet" type="text/css" href="/stylesheets/show_page.css" />

<div class="container-fluid parent">
	<div class="main">
		<div class="card mt-4 mb-4">
			<div class="m-3">
				<div class="title-portion">
					<div>
						<h2><%= bloginfo.title %></h2>
						
					</div>
					<% if(currentUser && bloginfo.author.id.equals(currentUser._id)){%>
					<div class="ml-auto">
						<a
							class="button btn btn-info"
							href="<%= bloginfo._id%>/edit"
							class="btn btn-info"
						>
							Edit
						</a>
						<form
							class="button"
							class="delete-form"
							action="/blogs/<%= bloginfo._id%>?_method=DELETE"
							method="POST"
						>
							<button class="btn btn-danger">Delete</button>
						</form>
					</div>
					<%}%>
				</div>
				<div class="BlogOwnerDetails">
					<h4 class="mb-3">By <%= bloginfo.author.username %></h4>&nbsp;&nbsp;&nbsp;
				<p class="text-muted font-italic">
							<% var m = moment(bloginfo.date); %> <%= m.fromNow() %>
						</p>
				</div>
				<div id="carouselExampleControls" class="carousel slide mb-3" data-ride="carousel">
					<div class="carousel-inner">
						<% bloginfo.img.forEach(function(blog,i){ %>
						<div class="carousel-item <%= i===0?'active':'' %>">
							<img src="<%= blog.url %>" class="d-block w-100" alt="..." />
						</div>
						<% }); %>
					</div>
					<% if(bloginfo.img.length>1) {%>
					<a
						class="carousel-control-prev"
						href="#carouselExampleControls"
						role="button"
						data-slide="prev"
					>
						<span class="carousel-control-prev-icon" aria-hidden="true"></span>
						<span class="sr-only">Previous</span>
					</a>
					<a
						class="carousel-control-next"
						href="#carouselExampleControls"
						role="button"
						data-slide="next"
					>
						<span class="carousel-control-next-icon" aria-hidden="true"></span>
						<span class="sr-only">Next</span>
					</a>
					<% } %>
				</div>

				<p><%= bloginfo.desc %></p>
			</div>
		</div>
		<div class="card mr-5 mb-4 p-3">
			<form class="form-comment" action="/blogs/<%= bloginfo._id%>/addcomment" method="POST">
				<div class="comment-area form-group">
					<textarea
						placeholder="Add a comment..."
						class="form-control"
						id="exampleFormControlTextarea1"
						name="text"
						rows="3"
					></textarea>
				</div>
				<div class="submit-button form-group">
					<button class="ml-3 mt-4 btn btn-info">
						Submit
					</button>
				</div>
			</form>
			<div>
				<h3 class="mb-3">Comments</h3>
				<% bloginfo.comments.forEach(function(comment){ %>
				<div class="p-2 card mb-3">
					<div class="inner-element-comment">
						<div class="commentDetails">
							<h5 class="comment-owner">
								<%= comment.author.username %>&nbsp;&nbsp;&nbsp;
							</h5>
							<p class="text-muted font-italic">
								<% var m = moment(comment.date); %> <%= m.fromNow() %>
							</p>
						</div>
						<% if(currentUser && comment.author.id.equals(currentUser._id)){%>
						<div class="ml-auto">
							<form
								action="/blogs/<%= bloginfo._id%>/<%=comment._id%>?_method=DELETE"
								method="POST"
							>
								<button class="btn btn-danger btn-sm">
									<i class="fas fa-trash"></i>
								</button>
							</form>
						</div>
						<% } %>
					</div>
					<p><%= comment.text %></p>
				</div>
				<%});%>
			</div>
		</div>
	</div>

	<div class="side-card mt-4 mb-4 ml-5">
		<div class="card p-3">
			Hello World<br />Hello World<br />Hello World<br />Hello World<br />
			Hello World<br />Hello World<br />Hello World<br />Hello World<br />
		</div>
	</div>
</div>

<%- include("partials/footer") %>